function update(item) {
  for (u in units)
    document.cookie = u + "=" + units[u][0][0] + "; path=/";
  document.cookie = "material" + "=" + material[0][0] + "; path=/";
  
  var od = item.od
  var tp = item.tp
  var td = tp * 5.5 / 16 * Math.sqrt(3); //5.635
  var pd = od - td;
  var id = od - td - td;
  var oa = Math.PI*od*od/4;
  var pa = Math.PI*pd*pd/4;
  var ia = Math.PI*id*id/4;
  var oc = Math.PI*od;
  var pc = Math.PI*pd;
  var ic = Math.PI*id;
  
  var out = "<table style=\"white-space:nowrap;font-size:200%\"><tr><td colspan=\"3\"><center><span ontouchmove=\"event.preventDefault()\" class=\"item\">" + item.name + " thread</span></center></td></tr>\
  <tr><td>Major        </td><td>" + diameter(od) + "</td><td>" + area(oa)    + "</td></tr>\
  <tr><td>Pitch        </td><td>" + diameter(pd) + "</td><td>" + area(pa)    + "</td></tr>\
  <tr><td>Minor        </td><td>" + diameter(id) + "</td><td>" + area(ia)    + "</td></tr>\
  <tr><td>Thread       </td><td>" + diameter(td) + "</td><td>" + area(oa-ia) + "</td></tr>\
  <tr><td>Lateral Major</td><td>" + diameter(oc) + "</td><td>" + area(oc*tp) + "</td></tr>\
  <tr><td>Lateral Pitch</td><td>" + diameter(pc) + "</td><td>" + area(pc*tp) + "</td></tr>\
  <tr><td>Lateral Minor</td><td>" + diameter(ic) + "</td><td>" + area(ic*tp) + "</td></tr>\
  </table><br>\
  <table style=\"white-space:nowrap;font-size:200%\"><tr><td ontouchmove=\"event.preventDefault()\" class=\"material\">" + material[0][0].name + "</td><td>Shank</td><td>Thread</td></tr>\
  <tr><td>Weight          </td><td>" + weight(material[0][0].weight*oa)             + "</td><td>" + weight(material[0][0].weight*pa)             + "</td></tr>\
  <tr><td>Yield Strength  </td><td>" + force(material[0][0].yield*oa)               + "</td><td>" + force(material[0][0].yield*ia)               + "</td></tr>\
  <tr><td>Tensile Strength</td><td>" + force(material[0][0].tensile*oa)             + "</td><td>" + force(material[0][0].tensile*ia)             + "</td></tr>\
  <tr><td>Yield Moment    </td><td>" + torque(material[0][0].yield*od*od*od/6000)   + "</td><td>" + torque(material[0][0].yield*id*id*id/6000)   + "</td></tr>\
  <tr><td>Tensile Moment  </td><td>" + torque(material[0][0].tensile*od*od*od/6000) + "</td><td>" + torque(material[0][0].tensile*id*id*id/6000) + "</td></tr>\
  <tr><td>Resistivity     </td><td>" + electrical(material[0][0].electrical/oa)     + "</td><td>" + electrical(material[0][0].electrical/ia)     + "</td></tr>\
  <tr><td>Conductivity    </td><td>" + thermal(material[0][0].thermal*oa)           + "</td><td>" + thermal(material[0][0].thermal*ia)           + "</td></tr>\
  </table><br>\
  <table style=\"white-space:nowrap;font-size:200%\"><tr><td colspan=\"4\">Tap Drills</td></tr>";
  
  var drills = {"#107":0.04830, "0.05 mm":0.05000, "#106":0.05840, "#105":0.06860, "#104":0.07870, "#103":0.08890, "#102":0.09910, "0.1 mm":0.10000, "#101":0.10920, "#100":0.11940, "#99":0.12950, "#98":0.13970, "#97":0.14990, "#96":0.16000, "#95":0.17020, 
  "#94":0.18030, "#93":0.19050, "0.2 mm":0.20000, "#92":0.20070, "#91":0.21080, "#90":0.22100, "#89":0.23110, "#88":0.24130, "#87":0.25400, "#86":0.26670, "#85":0.27940, "#84":0.29210, "0.3 mm":0.30000, "#83":0.30480, "#82":0.31750, "#81":0.33020, 
  "#80":0.34290, "#79":0.36800, "1/64 in":0.39690, "0.4 mm":0.40000, "#78":0.40640, "#77":0.45720, "0.5 mm":0.50000, "#76":0.50800, "#75":0.53340, "#74":0.57150, "0.6 mm":0.60000, "#73":0.60960, "#72":0.63500, "#71":0.66040, "0.7 mm":0.70000, "#70":0.71120, 
  "#69":0.74170, "#68":0.78740, "1/32 in":0.79380, "0.8 mm":0.80000, "#67":0.81280, "#66":0.83820, "#65":0.88900, "0.9 mm":0.90000, "#64":0.91440, "#63":0.93980, "#62":0.96520, "#61":0.99060, "1 mm":1.00000, "#60":1.01600, "#59":1.04140, "#58":1.06680, 
  "#57":1.09220, "1.1 mm":1.10000, "#56":1.18110, "3/64 in":1.19060, "1.2 mm":1.20000, "1.3 mm":1.30000, "#55":1.32080, "#54":1.39700, "1.4 mm":1.40000, "1.5 mm":1.50000, "#53":1.51130, "1/16 in":1.58750, "1.6 mm":1.60000, "#52":1.61290, "1.7 mm":1.70000, 
  "#51":1.70180, "#50":1.77800, "1.8 mm":1.80000, "#49":1.85420, "1.9 mm":1.90000, "#48":1.93040, "5/64 in":1.98440, "#47":1.99390, "2 mm":2.00000, "#46":2.05740, "#45":2.08280, "2.1 mm":2.10000, "#44":2.18440, "2.2 mm":2.20000, "#43":2.26060, "2.3 mm":2.30000, 
  "#42":2.37490, "3/32 in":2.38130, "2.4 mm":2.40000, "#41":2.43840, "#40":2.48920, "2.5 mm":2.50000, "#39":2.52730, "#38":2.57810, "2.6 mm":2.60000, "#37":2.64160, "2.7 mm":2.70000, "#36":2.70510, "7/64 in":2.77810, "#35":2.79400, "2.8 mm":2.80000, 
  "#34":2.81940, "#33":2.87020, "2.9 mm":2.90000, "#32":2.94640, "3 mm":3.00000, "#31":3.04800, "3.1 mm":3.10000, "1/8 in":3.17500, "3.2 mm":3.20000, "#30":3.26390, "3.3 mm":3.30000, "3.4 mm":3.40000, "#29":3.45440, "3.5 mm":3.50000, "#28":3.56870, 
  "9/64 in":3.57190, "3.6 mm":3.60000, "#27":3.65760, "3.7 mm":3.70000, "#26":3.73380, "#25":3.79730, "3.8 mm":3.80000, "#24":3.86080, "3.9 mm":3.90000, "#23":3.91160, "5/32 in":3.96880, "#22":3.98780, "4 mm":4.00000, "#21":4.03860, "#20":4.08940, 
  "4.1 mm":4.10000, "4.2 mm":4.20000, "#19":4.21640, "4.3 mm":4.30000, "#18":4.30530, "11/64 in":4.36560, "#17":4.39420, "4.4 mm":4.40000, "#16":4.49580, "4.5 mm":4.50000, "#15":4.57200, "4.6 mm":4.60000, "#14":4.62280, "#13":4.69900, "4.7 mm":4.70000, 
  "3/16 in":4.76250, "4.8 mm":4.80000, "#12":4.80060, "#11":4.85140, "4.9 mm":4.90000, "#10":4.91490, "#9":4.97840, "5 mm":5.00000, "#8":5.05460, "5.1 mm":5.10000, "#7":5.10540, "13/64 in":5.15940, "#6":5.18160, "5.2 mm":5.20000, "#5":5.21970, "5.3 mm":5.30000, 
  "#4":5.30860, "5.4 mm":5.40000, "#3":5.41020, "5.5 mm":5.50000, "7/32 in":5.55630, "5.6 mm":5.60000, "#2":5.61340, "5.7 mm":5.70000, "#1":5.79120, "5.8 mm":5.80000, "5.9 mm":5.90000, "A":5.94360, "15/64 in":5.95310, "6 mm":6.00000, "B":6.04520, 
  "6.1 mm":6.10000, "C":6.14680, "6.2 mm":6.20000, "D":6.24840, "6.3 mm":6.30000, "1/4 in":6.35000, "E":6.35000, "6.4 mm":6.40000, "6.5 mm":6.50000, "F":6.52780, "6.6 mm":6.60000, "G":6.62940, "6.7 mm":6.70000, "17/64 in":6.74690, "H":6.75640, 
  "6.8 mm":6.80000, "6.9 mm":6.90000, "I":6.90880, "7 mm":7.00000, "J":7.03580, "7.1 mm":7.10000, "K":7.13740, "9/32 in":7.14380, "7.2 mm":7.20000, "7.3 mm":7.30000, "L":7.36600, "7.4 mm":7.40000, "M":7.49300, "7.5 mm":7.50000, "19/64 in":7.54060, 
  "7.6 mm":7.60000, "N":7.67080, "7.7 mm":7.70000, "7.8 mm":7.80000, "7.9 mm":7.90000, "5/16 in":7.93750, "8 mm":8.00000, "O":8.02640, "8.1 mm":8.10000, "8.2 mm":8.20000, "P":8.20420, "8.3 mm":8.30000, "21/64 in":8.33440, "8.4 mm":8.40000, "Q":8.43280, 
  "8.5 mm":8.50000, "8.6 mm":8.60000, "R":8.61060, "8.7 mm":8.70000, "11/32 in":8.73130, "8.8 mm":8.80000, "S":8.83920, "8.9 mm":8.90000, "9 mm":9.00000, "T":9.09320, "9.1 mm":9.10000, "23/64 in":9.12810, "9.2 mm":9.20000, "9.3 mm":9.30000, "U":9.34720, 
  "9.4 mm":9.40000, "9.5 mm":9.50000, "3/8 in":9.52500, "V":9.57580, "9.6 mm":9.60000, "9.7 mm":9.70000, "9.8 mm":9.80000, "W":9.80440, "9.9 mm":9.90000, "25/64 in":9.92190, "10 mm":10.0000, "X":10.0838, "Y":10.2616, "13/32 in":10.3188, "Z":10.4902, 
  "10.5 mm":10.5000, "27/64 in":10.7156, "11 mm":11.0000, "7/16 in":11.1125, "11.5 mm":11.5000, "29/64 in":11.5094, "15/32 in":11.9063, "12 mm":12.0000, "31/64 in":12.3031, "12.5 mm":12.5000, "1/2 in":12.7000, "13 mm":13.0000, "33/64 in":13.0969, 
  "17/32 in":13.4938, "13.5 mm":13.5000, "35/64 in":13.8906, "14 mm":14.0000, "9/16 in":14.2875, "14.5 mm":14.5000, "37/64 in":14.6844, "15 mm":15.0000, "19/32 in":15.0813, "39/64 in":15.4781, "15.5 mm":15.5000, "5/8 in":15.8750, "16 mm":16.0000, 
  "41/64 in":16.2719, "16.5 mm":16.5000, "17 mm":17.0000, "43/64 in":17.0656, "11/16 in":17.4625, "17.5 mm":17.5000, "45/64 in":17.8594, "18 mm":18.0000, "23/32 in":18.2563, "18.5 mm":18.5000, "47/64 in":18.6531, "19 mm":19.0000, "3/4 in":19.0500, 
  "49/64 in":19.4469, "19.5 mm":19.5000, "25/32 in":19.8438, "20 mm":20.0000, "51/64 in":20.2406, "20.5 mm":20.5000, "13/16 in":20.6375, "21 mm":21.0000, "53/64 in":21.0344, "27/32 in":21.4313, "21.5 mm":21.5000, "55/64 in":21.8281, "22 mm":22.0000, 
  "7/8 in":22.2250, "22.5 mm":22.5000, "57/64 in":22.6219, "23 mm":23.0000, "29/32 in":23.0188, "21/23 in":23.1913, "59/64 in":23.4156, "23.5 mm":23.5000, "15/16 in":23.8125, "24 mm":24.0000, "61/64 in":24.2094, "24.5 mm":24.5000, "31/32 in":24.6063, 
  "25 mm":25.0000, "63/64 in":25.0031, "1 in":25.4000, "25.5 mm":25.5000, "1 1/64 in":25.7969, "26 mm":26.0000, "1 1/32 in":26.1938, "26.5 mm":26.5000, "1 3/64 in":26.5906, "1 1/16 in":26.9875, "27 mm":27.0000, "1 5/64 in":27.3844, "27.5 mm":27.5000, 
  "1 3/32 in":27.7813, "28 mm":28.0000, "1 7/64 in":28.1781, "28.5 mm":28.5000, "1 1/8 in":28.5750, "1 9/64 in":28.9719, "29 mm":29.0000, "1 5/32 in":29.3688, "29.5 mm":29.5000, "1 11/64 in":29.7656, "30 mm":30.0000, "1 3/16 in":30.1625, "30.5 mm":30.5000, 
  "1 13/64 in":30.5594, "1 7/32 in":30.9563, "31 mm":31.0000, "1 15/64 in":31.3531, "31.5 mm":31.5000, "1 1/4 in":31.7500, "32 mm":32.0000, "1 17/64 in":32.1469, "32.5 mm":32.5000, "1 9/32 in":32.5438, "1 19/64 in":32.9406, "33 mm":33.0000, "1 5/16 in":33.3375, 
  "33.5 mm":33.5000, "1 21/64 in":33.7344, "34 mm":34.0000, "1 11/32 in":34.1313, "34.5 mm":34.5000, "1 23/64 in":34.5281, "1 3/8 in":34.9250, "35 mm":35.0000, "1 25/64 in":35.3219, "35.5 mm":35.5000, "1 13/32 in":35.7188, "36 mm":36.0000, "1 27/64 in":36.1156, 
  "36.5 mm":36.5000, "1 7/16 in":36.5125, "1 29/64 in":36.9094, "37 mm":37.0000, "1 15/32 in":37.3063, "37.5 mm":37.5000, "1 31/64 in":37.7031, "38 mm":38.0000, "1 1/2 in":38.1000};
  for (x in drills)
    if (id <= drills[x] && drills[x] <= od) out += "<tr><td>"+Math.round(50*(od-drills[x])/td)+"%</td><td>" + x + "</td><td>" + diameter(drills[x]) + "</td></tr>\n";
  document.documentElement.innerHTML = out +"</table><br>";
}

update(items[0]);